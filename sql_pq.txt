# Here are some practice questions for you to work on using the Sakila database:

-- Retrieve the names of all customers who live in the city with ID 200. 

select first_name , last_name , city from customer c
join address a on c.address_id = a.address_id
join city ci on a.city_id = ci.city_id
where ci.city_id = 200;   

-- Retrieve the rental information for the film with the title "Casablanca."
select r.rental_id , rental_date , return_date , amount  from rental r
join payment p on r.rental_id = p.rental_id
join inventory i on r.inventory_id = i.inventory_id
join film f on i.film_id = f.film_id
where title = "CASABLANCA SUPER";

-- Retrieve the total number of films in each language.

select count(*) as num_films , name as language from film f
join language l on f.language_id  = l.language_id
group by name;

-- Retrieve the top 5 most rented films.

select title , count(distinct rental_id) as num_times_rented
from rental r
join inventory i on r.inventory_id = i.inventory_id
join film f on i.film_id = f.film_id
group by title
order by num_times_rented desc
limit 5;

-- Retrieve the staff members who have not made any payments.

select s.staff_id , s.first_name , s.last_name , p.payment_id
from staff s
left join payment p
on s.staff_id = p.staff_id
where p.amount = 0;

-- Retrieve the customer ID, first name, and last name of the customers who have rented films but have not made any payments.

select c.customer_ID, first_name, last_name , r.rental_id, p.payment_id , f.title from customer c
 join payment p on c.customer_id = p.customer_id
 join rental r on c.customer_id = r.customer_id
join inventory i on r.inventory_id = i.inventory_id
join film f on i.film_id = f.film_id
where p.amount  = 0;

-- Retrieve the rental information for the films rented by a specific customer (customer ID 10) in alphabetical order by film title.

select r.rental_id , title ,  rental_date , return_date , p.payment_id , p.amount from rental r
join payment p on r.rental_id  = p.rental_id
join inventory i on r.inventory_id = i.inventory_id
join film f on i.film_id = f.film_id
where r.customer_id = 10
order by title ;

-- Retrieve the customers who have made more than 10 rentals.

select c.customer_id , c.first_name , c.last_name , count(rental_id) as rentals  from customer c 
inner join rental r on c.customer_id = r.customer_id
group by c.customer_id , c.first_name , c.last_name 
having rentals > 10;

-- Retrieve the films in the "Comedy" category with a rental rate of less than 2.00.

select f.film_id , title , rental_rate , c.name 
from film f
join film_category fc on f.film_id = fc.film_id
join category c on fc.category_id = c.category_id
where c.name = "Comedy" and rental_rate < 2.00;

/*  Retrieve the customer ID, first name, and last name of the customers who have rented
 all the films in a specific category (e.g., "Horror") */
 
 select c.customer_ID, first_name, last_name , r.rental_id,  f.title from customer c
 join rental r on c.customer_id = r.customer_id
join inventory i on r.inventory_id = i.inventory_id
join film f on i.film_id = f.film_id
join film_category fc on f.film_id = fc.film_id
join category ca on fc.category_id = ca.category_id
where ca.name = "Horror";

------------------------------------------------------------

 /* World Database Queries */
 
## Here are practice questions using the World Database in MySQL:

-- Retrieve the names of all countries in the database.

    select name from country;
	
-- Retrieve the total number of countries in each continent.

      select count(*)as num_countries, continent from country
      group by continent;
	  
-- Retrieve the population of a specific country (e.g., "United States").

     select name , population from country
     where name = "United States";
	 
-- Retrieve the top 5 countries with the highest life expectancy.

    select name , lifeExpectancy from country
     order by LifeExpectancy desc
      limit 5;
	  
-- Retrieve the languages spoken in a specific country (e.g., "Germany") along with the percentage of speakers.

select language , percentage from countrylanguage cl
join country c on cl.CountryCode = c.Code
where name = "Germany";

-- Retrieve the capital city and its population for each country.

select c.name as country ,ci.name as capital , ci.population from  country c
join city ci on c.Capital = ci.id;

-- Retrieve the countries with a population greater than 100 million people.

select name , population from country 
where population > 100000000;

-- Retrieve the top 5 most spoken languages worldwide along with the number of countries where they are spoken.

select language , count(name) as num_countries from countrylanguage cl
join country c on cl.CountryCode = c.code
group by language 
order by num_countries desc
limit 5;

-- Retrieve the countries where English is an official language.

select c.name as country  from countrylanguage cl
join country c on cl.CountryCode = c.code
where language = "English" and isofficial = "T";

-- Retrieve the continents and their average life expectancy.

select continent , round(avg(lifeExpectancy) ,4) as avg_life_expectancy from country
group by continent;
